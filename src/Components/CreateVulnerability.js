import { Box, Button, Dialog, DialogActions, DialogContent, DialogTitle, TextField } from '@mui/material';
import Textarea from '@mui/joy/Textarea';
import React, { useState } from 'react';

const CreateVulnerability = ({ createOpen, setCreateOpen, vulnerability, setVulnerability }) => {
    const [data, setData] = useState({});

    const handleOnBlur = e => {
        const field = e.target.name;
        const value = e.target.value;
        const newData = { ...data };
        newData[field] = value;
        setData(newData);
    }

    const handleSubmit = e => {
        e.preventDefault();

        setVulnerability([...vulnerability, data])
        e.target.reset();
        setCreateOpen(false);
    };

    const handleOpen = () => {
        setCreateOpen(true);
    };

    const handleClose = () => {
        setCreateOpen(false);
    };

    return (
        <Box>
            <Box style={{ marginTop: '-50px', marginBottom: '24px', display: 'flex', justifyContent: 'end' }} >
                <Button variant="outlined" onClick={handleOpen}>CREATE VULNERABILITY</Button>
            </Box>

            <Dialog maxWidth="sm" fullWidth={true} open={createOpen} onClose={handleClose}>
                <DialogTitle>CREATE A NEW VULNERABILITY</DialogTitle>
                <DialogContent>

                    <form onSubmit={handleSubmit}>
                        <TextField
                            required
                            onBlur={handleOnBlur}
                            name="name"
                            label="Enter Name"
                            variant="standard"
                            sx={{ width: '100%', fontsize: '18px', color: 'black' }}
                        />

                        <br /><br />

                        <TextField
                            required
                            onBlur={handleOnBlur}
                            name="title"
                            label="Enter Title"
                            variant="standard"
                            sx={{ width: '100%', fontsize: '18px', color: 'black' }}
                        />

                        <br /><br />

                        <Textarea
                            minRows={4}
                            onBlur={handleOnBlur}
                            name="description"
                            placeholder="Enter Description"
                            color="neutral"
                            size="lg"
                            variant="outlined"
                            sx={{ width: '100%', fontsize: '18px', color: 'black' }}
                        />

                        <br />

                        <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center' }}>
                            <Box sx={{ width: '100%', textAlign: 'start' }}>
                                <Button
                                    type="submit"
                                    color="primary"
                                    variant="contained"
                                >
                                    Submit
                                </Button>
                            </Box>
                        </Box>
                    </form>

                </DialogContent>
                <DialogActions>
                    <Button onClick={handleClose}>Close</Button>
                </DialogActions>
            </Dialog>
        </Box>
    );
};

export default CreateVulnerability;